# üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: TCP-—á–∞—Ç-—Å–µ—Ä–≤–µ—Ä –Ω–∞ Rust

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π TCP-—á–∞—Ç, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤. –°–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞ (broadcast) –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

---

## 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 2.1. –°–µ—Ä–≤–µ—Ä
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
- –£–º–µ–µ—Ç:
  - –ü—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
  - –ü–æ–ª—É—á–∞—Ç—å –∏ —Ä–∞—Å—Å—ã–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤—Å–µ–º –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –æ—Ç–∫–ª—é—á–µ–Ω–∏—è, –æ—à–∏–±–∫–∏).

### 2.2. –ö–ª–∏–µ–Ω—Ç
- –ú–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ TCP.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
  - –í–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
  - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º (`@all`) –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (`@username`)
  - –ü–æ–ª—É—á–∞—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã:
  - `@users` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `@exit` ‚Äî –≤—ã–π—Ç–∏ –∏–∑ —á–∞—Ç–∞

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 3.1. –°–µ—Ä–≤–µ—Ä
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (`tokio`).
- –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∞–∫—Ü–µ–ø—Ç–æ—Ä (`TcpListener`)
  - –û—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö:
  - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üî –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- –®–∏–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `mpsc::channel` –∏–ª–∏ `broadcast` –∏–∑ `tokio`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:
  - –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥
  - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### 3.2. –ö–ª–∏–µ–Ω—Ç
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö –ø–æ—Ç–æ–∫–∞—Ö:
  - –û–¥–∏–Ω —Å–ª—É—à–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –∏ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
  - –î—Ä—É–≥–æ–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

---

## 4. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- –Ø–∑—ã–∫: **Rust**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å: **Tokio**
- –†–∞–±–æ—Ç–∞ —Å TCP: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ + Tokio
- –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è: —Å—Ç—Ä–æ–∫–∏ –≤ UTF-8
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–≤–æ–∑–º–æ–∂–Ω—ã–µ):
  - `tokio::net`
  - `tokio::sync`
  - `tokio::task`
  - `tokio::io`

---

## 5. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
tcp-chat/
‚îú‚îÄ‚îÄ Cargo.toml
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ main.rs
‚îÇ       ‚îú‚îÄ‚îÄ client_handler.rs
‚îÇ       ‚îú‚îÄ‚îÄ message.rs
‚îÇ       ‚îî‚îÄ‚îÄ user_registry.rs
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ main.rs
‚îÇ       ‚îú‚îÄ‚îÄ message.rs
‚îÇ       ‚îî‚îÄ‚îÄ input_handler.rs
‚îî‚îÄ‚îÄ README.md
```

---

## 6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –∫–æ–¥–∞

- –ß–∏—Å—Ç—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (doc comments)
- Unit- –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `thiserror` / `anyhow`
- Readme —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ –∑–∞–ø—É—Å–∫—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- CI —á–µ—Ä–µ–∑ GitHub Actions (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

---

## 7. –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–∏—á–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ)

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TLS (–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- –¶–≤–µ—Ç–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≤ –∫–ª–∏–µ–Ω—Ç–µ (—á–µ—Ä–µ–∑ `ansi_term` –∏–ª–∏ `crossterm`)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## 8. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
cargo run --bin server
```

**–ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞:**
```bash
cargo run --bin client
```

**–í–≤–æ–¥:**
```
Enter your username: Alice
Connected to chat.
Type @users to see online users.
Hello world!            // –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –≤—Å–µ–º
@Bob Hi Bob!            // –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ Bob
@exit                   // –≤—ã—Ö–æ–¥
```